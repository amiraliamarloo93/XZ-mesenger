<!doctype html>
<html lang="fa">
<head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>ورود - XZ</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div style="display:flex;align-items:center;justify-content:center;height:100vh;">
  <div class="panel" style="width:360px">
    <h3>ورود</h3>
    <input id="phone" placeholder="شماره موبایل" style="width:100%;padding:10px;border-radius:8px">
    <input id="pin" placeholder="رمز ۴ رقمی" maxlength="4" type="password" style="width:100%;padding:10px;border-radius:8px;margin-top:8px">
    <div style="display:flex;gap:8px;margin-top:10px">
      <button id="loginBtn" class="action-btn">ورود</button>
      <a href="signup.html"><button class="action-btn" style="background:#ccc;color:#000">ثبت‌نام</button></a>
    </div>
    <p id="msg" style="color:#a00;margin-top:8px"></p>
  </div>
</div>
<script>
document.getElementById("loginBtn").addEventListener("click", async ()=>{
  const phone=document.getElementById("phone").value.trim();
  const pin=document.getElementById("pin").value.trim();
  if(!phone || pin.length!==4){document.getElementById("msg").innerText="شماره/رمز را وارد کنید"; return;}
  const res = await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone,pin})});
  const data = await res.json();
  if(data.success){
    localStorage.setItem("user", JSON.stringify(data.user));
    localStorage.setItem("phone", data.user.phone);
    window.location.href = "groups.html";
  } else {
    document.getElementById("msg").innerText = data.message || "خطا";
  }
});
</script>
</body>
</html>
